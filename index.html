<!DOCTYPE html>

<html>

<head>
	<meta charset="utf-8" />
	<meta name="viewport"
		content="width=device-width,initial-scale=1,minimum-scale=1,maximum-scale=1,user-scalable=no" />
	<title>数据观察</title>
	<link rel="stylesheet" href="css/bootstrap.min.css" />
	<link rel="stylesheet" type="text/css" href="css/app.css" />

</head>

<body>
	<header id="header">
		<h3 class="header-title" style="margin-top: 0px;">北京市线下中小微消费市场数据观察</h3>
		<div class="header-info header-info-l">数据来源：XXX
			<form enctype="multipart/form-data" style="display: inline-block;">
				<input id="upload" type=file name="files[]">
			</form>
		</div>
		<div class="header-info header-info-r">数据日期：<span id="nowDate"></span></div>
	</header>

	<!-- <footer id="footer"></footer> -->

	<div class="wrapper">
		<div class="container-fluid">
			<div class="row fill-h">
				<div class="col-lg-6 fill-h">
					<div class="xpanel-wrapper xpanel-wrapper-1">
						<div class="xpanel flex-container-column">
							<div class="chart-wrapper flex2">
								<h3 class="chart-title">整体情况-一季度加总</h3>
								<div class="chart-div chart-done">
									<table class="data-t" style="text-align: center;" id="data-t-all">
										<tr>
											<td id="td0">
												<p><a onclick="showSankeyDiagram()">交易总金额</a></p>
												<p><span id="v0">0</span></p>
												<p>同比增长<span id="v1" style="font-size: 16px;">0</span></p>
												<p>较疫情前增长<span id="v2" style="font-size: 16px;">0</span></p>
											</td>
											<td id="td1">
												<p>交易总笔数</p>
												<p><span id="v0">0</span></p>
												<p>同比增长<span id="v1" style="font-size: 16px;">0</span></p>
												<p>较疫情前增长<span id="v2" style="font-size: 16px;">0</span></p>
											</td>
											<td id="td2">
												<p>客单价</p>
												<p><span id="v0">0</span></p>
												<p>同比增长<span id="v1" style="font-size: 16px;">0</span></p>
												<p>较疫情前增长<span id="v2" style="font-size: 16px;">0</span></p>
											</td>
											<td id="td3">
												<p>月营业额</p>
												<p><span id="v0">0</span></p>
												<p>同比增长<span id="v1" style="font-size: 16px;">0</span></p>
												<p>较疫情前增长<span id="v2" style="font-size: 16px;">0</span></p>
											</td>
											<td id="td4">
												<p>店均交易笔数</p>
												<p><span id="v0">0</span></p>
												<p>同比增长<span id="v1" style="font-size: 16px;">0</span></p>
												<p>较疫情前增长<span id="v2" style="font-size: 16px;">0</span></p>
											</td>

										</tr>
									</table>
								</div>
							</div>
							<div class="flex9 flex-container-row">
								<div class="flex3 flex-container-column">
									<div class="chart-wrapper flex2">
										<h3 class="chart-title">1、2、3月各项指标</h3>
										<ul id="myTab" class="nav nav-tabs flex-container-row">
											<li class="active flex1">
												<a href="#indicator-1" data-toggle="tab">交易总金额</a>
											</li>
											<li class="flex1"><a href="#indicator-2" data-toggle="tab">交易总笔数</a></li>
											<li class="flex1"><a href="#indicator-3" data-toggle="tab">客单价</a></li>
											<li class="flex1"><a href="#indicator-4" data-toggle="tab">月营业额</a></li>
											<li class="flex1"><a href="#indicator-5" data-toggle="tab">店均交易笔数</a></li>
										</ul>

										<div id="myTabContent" class="tab-content" style="height: 100%;">
											<div class="tab-pane fade in active" id="indicator-1" style="height: 100%;">
												<div class="chart-div2" id="indicator-bar-chart">
												</div>
											</div>
											<div class="tab-pane fade" id="indicator-2" style="height: 100%;">
												<div class="chart-div2" id="indicator-bar-chart">
												</div>
											</div>
											<div class="tab-pane fade" id="indicator-3" style="height: 100%;">
												<div class="chart-div2" id="indicator-bar-chart">
												</div>
											</div>
											<div class="tab-pane fade" id="indicator-4" style="height: 100%;">
												<div class="chart-div2" id="indicator-bar-chart">
												</div>
											</div>
											<div class="tab-pane fade" id="indicator-5" style="height: 100%;">
												<div class="chart-div2" id="indicator-bar-chart">
												</div>
											</div>
										</div>
									</div>
									<div class="chart-wrapper flex5">
										<h3 class="chart-title">各行业排名</h3>
										<div class="chart-div" id="rankChart"
											style="overflow-y: scroll;scrollbar-width: none;">
											<!-- <div class="chart-loader">
												<div class="loader"></div>
											</div> -->
										</div>
									</div>
								</div>
								<div class="flex5 flex-container-column">
									<div class="chart-wrapper flex5">
										<div class="flex-container-row" style="height: 100%;">
											<div class="chart-wrapper flex5">
												<h3 class="chart-title">各城区热力图</h3>
												<div class="chart-div" id="map-area-chart">
												</div>
											</div>
											<div class="chart-wrapper flex2">
												<h3 class="chart-title" id="area-rank-h3">城区内行业排名</h3>
												<div class="chart-div flex-container-column" id="map-area-rank-chart"
													style="overflow-y: scroll;">
												</div>
											</div>
										</div>
									</div>
									<div class="chart-wrapper flex5">
										<div class="flex-container-row" style="height: 100%;">
											<div class="chart-wrapper flex5">
												<h3 class="chart-title">各商圈热力图</h3>
												<div class="chart-div" id="map-business-chart">
												</div>
											</div>
											<div class="chart-wrapper flex2">
												<h3 class="chart-title" id="business-rank-h3">商圈内排名</h3>
												<div class="chart-div flex-container-column"
													id="map-business-rank-chart" style="overflow-y: scroll;">
												</div>
											</div>
										</div>
									</div>
								</div>
							</div>
						</div>
						<div class="xpanel-wrapper-footer"></div>
					</div>
				</div>

				<div class="col-lg-6 fill-h">
					<div class="xpanel-wrapper xpanel-wrapper-1">
						<div class="xpanel flex-container-column" id="detail-business-div">
							<div class="chart-wrapper flex2">
								<h3 class="chart-title" id="detail_area_h3">海淀区具体交易情况</h3>
								<div class="chart-div chart-done">
									<table class="data-t" style="text-align: center;" id="data-t-area">
										<tr>
											<td id="td0">
												<p>交易总金额</p>
												<p><span id="v0">0</span></p>
												<p>同比增长<span id="v1" style="font-size: 16px;">0</span></p>
												<p>较疫情前增长<span id="v2" style="font-size: 16px;">0</span></p>
											</td>
											<td id="td1">
												<p>交易总笔数</p>
												<p><span id="v0">0</span></p>
												<p>同比增长<span id="v1" style="font-size: 16px;">0</span></p>
												<p>较疫情前增长<span id="v2" style="font-size: 16px;">0</span></p>
											</td>
											<td id="td2">
												<p>客单价</p>
												<p><span id="v0">0</span></p>
												<p>同比增长<span id="v1" style="font-size: 16px;">0</span></p>
												<p>较疫情前增长<span id="v2" style="font-size: 16px;">0</span></p>
											</td>
											<td id="td3">
												<p>月营业额</p>
												<p><span id="v0">0</span></p>
												<p>同比增长<span id="v1" style="font-size: 16px;">0</span></p>
												<p>较疫情前增长<span id="v2" style="font-size: 16px;">0</span></p>
											</td>
											<td id="td4">
												<p>店均交易笔数</p>
												<p><span id="v0">0</span></p>
												<p>同比增长<span id="v1" style="font-size: 16px;">0</span></p>
												<p>较疫情前增长<span id="v2" style="font-size: 16px;">0</span></p>
											</td>

										</tr>
									</table>
								</div>
							</div>
							<div class="flex9 flex-container-row">
								<!-- <div class="chart-wrapper flex3">
									<h3 class="chart-title">活力商圈榜单
									</h3>
									<div class="chart-div chart-done">
									</div>
								</div>
								<div class="chart-wrapper flex3">
									<h3 class="chart-title">各行业
									</h3>
									<div class="chart-div chart-done">
									</div>
								</div>
								<div class="chart-wrapper flex3">
									<h3 class="chart-title">规模行业、成长行业
									</h3>
									<div class="chart-div chart-done">
									</div>
								</div> -->
								<div class="chart-wrapper flex4">
									<h3 class="chart-title" id="bubble-h3">海淀区-一级分类
									</h3>
									<div class="chart-div" id="bubble-chart">
									</div>
								</div>
								<div class="chart-wrapper flex2">
									<h3 class="chart-title" id="area-business-rank-h3">海淀区-生活百货 二级分类排名</h3>
									<div class="chart-div flex-container-column" id="area-business-rank-chart"
										style="overflow-y: scroll;">
									</div>
								</div>
							</div>
						</div>
						<div class="xpanel flex-container-column" id="sankey-diagram-div" style="display: none;">
							<div class="chart-wrapper flex2" style="border: 0px;">
								<h3 class="chart-title" id="detail_area_h3">城市互动</h3>
								<div class="chart-div chart-done flex-container-row" style="height: 95%;top: 20px;">
									<div class="chart-wrapper flex5" style="border: 0px;">
										<h3 class="chart-title" style="text-align: center;">北京消费构成 Top 5:</h3>
										<div class="chart-div flex-container-column" id="beijingin-rank-chart"
											style="overflow-y: scroll;margin-left: 20%;">
										</div>
									</div>
									<div class="chart-wrapper flex5" style="border: 0px;">
										<h3 class="chart-title" style="text-align: center;">北京人在外地消费 Top 5:</h3>
										<div class="chart-div flex-container-column" id="beijingout-rank-chart"
											style="overflow-y: scroll;margin-left: 20%;">
										</div>
									</div>
								</div>
							</div>
							<div class="flex9 flex-container-row">
								<div class="chart-wrapper flex4" style="border: 0px;">
									<!-- <h3 class="chart-title" id="sankey-h3">城市互动
									</h3> -->
									<div class="chart-div" id="sankey-chart">
									</div>
								</div>
							</div>
						</div>
						<div class="xpanel-wrapper-footer"></div>
					</div>
				</div>
			</div>
		</div>
	</div>

	<script type="text/javascript" src="js/jquery-3.3.1.min.js"></script>
	<script type="text/javascript" src="js/xlsx.full.min.js"></script>
	<script type="text/javascript" src="js/countUp.min.js"></script>
	<script type="text/javascript" src="js/echarts55.min.js"></script>
	<script type="text/javascript" src="js/echarts-map-china.js"></script>
	<script type="text/javascript" src="js/echarts-theme-shine.js"></script>
	<script type="text/javascript" src="js/bootstrap.min.js"></script>
	<script type="text/javascript" src="js/beijing.js"></script>
	<script type="text/javascript" src="js/index.js"></script>

	<script type="text/javascript">
		$(function () {
			//获取当天日期
			(function () {
				const now = new Date();
				const year = now.getFullYear();
				const month = now.getMonth() + 1;
				const day = now.getDate();
				$("#nowDate").html(year + "年" + month + "月" + day + "日");
			})();

			var request = new XMLHttpRequest();
			request.open('GET', 'data/首都消费数据汇总.xlsx', true);
			request.setRequestHeader('Content-Type', 'application/x-www-form-urlencoded; charset=UTF-8');
			request.responseType = 'blob';

			request.onload = function (e) {
				if (this.status === 200) {
					var blob = this.response;
					// console.log(blob);
					var xl2json = new ExcelToJSON();
					xl2json.parseExcel(blob);
					// if (window.navigator.msSaveOrOpenBlob) {
					// 	window.navigator.msSaveBlob(blob, 'fileName.xlsx');
					// }
					// else {
					// 	var downloadLink = window.document.createElement('a');
					// 	var contentTypeHeader = request.getResponseHeader("Content-Type");
					// 	downloadLink.href = window.URL.createObjectURL(new Blob([blob], { type: contentTypeHeader }));
					// 	downloadLink.download = 'fileName.xlsx';
					// 	document.body.appendChild(downloadLink);
					// 	downloadLink.click();
					// 	document.body.removeChild(downloadLink);
					// }
				}
			};
			request.send();
		});
	</script>
</body>

</html>